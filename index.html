<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Abdul Hadi Fast Food</title>
<style>
:root{
  --bg:#f7f3f1;
  --card:#fff;
  --accent:#800000; /* maroon */
  --accent-light:#9b2b2b;
  --muted:#6b6b6b;
  --green:#25D366;
  --text:#2b2b2b;
}
*{box-sizing:border-box;font-family:Inter, Poppins, sans-serif;margin:0;padding:0}
html,body{height:100%}
body{
  background:var(--bg);
  color:var(--text);
  line-height:1.4;
  padding-bottom:160px;
  overflow-x:hidden; /* prevent horizontal shift on mobile */
}
header{
  background:linear-gradient(90deg,var(--accent),var(--accent-light));
  color:#fff;padding:18px 12px;display:flex;align-items:center;gap:12px;
  box-shadow:0 4px 12px rgba(0,0,0,0.12);position:sticky;top:0;z-index:2000;
}
.header-logo{width:72px;height:72px;border-radius:10px;object-fit:contain}
.header-title{font-weight:900;font-size:30px;letter-spacing:0.5px}
.header-sub{font-size:12px;opacity:0.95}
.container{max-width:1100px;margin:18px auto;padding:0 14px}

/* category nav */
.cat-nav{
  display:flex;gap:8px;overflow:auto;padding:8px 6px;margin-bottom:8px;
  -webkit-overflow-scrolling:touch;
  scrollbar-width:none; /* firefox */
}
.cat-nav::-webkit-scrollbar{display:none} /* hide scroll on webkit */
.cat-nav a{white-space:nowrap;padding:8px 12px;border-radius:999px;background:#fff;color:var(--accent);font-weight:700;box-shadow:0 4px 12px rgba(0,0,0,0.06);text-decoration:none}

/* section header */
.section-header{display:flex;align-items:center;gap:12px;justify-content:center;margin:8px 0 12px 0}
.section-banner{background:var(--accent);color:#fff;padding:6px 12px;border-radius:8px;font-weight:800;letter-spacing:0.6px}
.section-title{font-size:20px;font-weight:800;color:var(--accent);text-align:center;margin-top:8px}

/* cards grid */
.grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
.card{background:var(--card);padding:8px;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.06);text-align:center;overflow:hidden}
.card img{width:100%;height:140px;object-fit:cover;border-radius:8px}
.card .name{font-weight:800;margin-top:8px}
.card .price{color:var(--accent);font-weight:800;margin:6px 0}
.controls{display:flex;gap:8px;align-items:center;justify-content:center;margin-top:8px}
.btn{background:var(--accent);color:#fff;border:none;padding:8px 12px;border-radius:8px;font-weight:800;cursor:pointer;box-shadow:0 6px 14px rgba(0,0,0,0.12);transition:transform 0.12s ease}
.btn:active{transform:translateY(2px)}
.qty-controls{display:flex;gap:8px;align-items:center}
.qty-btn{width:36px;height:36px;border-radius:8px;border:none;background:#eee;font-weight:800;cursor:pointer}
.qty-num{min-width:32px;text-align:center;font-weight:800}

/* Deals */
.deals-grid{display:flex;gap:12px;flex-wrap:wrap;justify-content:center}
.deal-card{background:linear-gradient(180deg,#fff,#fff);padding:12px;border-radius:12px;box-shadow:0 8px 22px rgba(0,0,0,0.08);width:100%;max-width:900px;display:flex;gap:12px;align-items:center}
.deal-card img{width:120px;height:80px;object-fit:cover;border-radius:8px}
.deal-info{flex:1}

/* checkout bar */
.cart-bar{position:fixed;left:50%;transform:translateX(-50%);bottom:18px;background:linear-gradient(90deg,var(--accent),var(--accent-light));color:#fff;padding:12px 20px;border-radius:999px;font-weight:900;box-shadow:0 8px 24px rgba(0,0,0,0.2);z-index:2000;display:flex;gap:12px;align-items:center}
.checkout-panel{position:fixed;left:0;right:0;bottom:-110%;background:#fff;border-radius:18px 18px 0 0;padding:16px;box-shadow:0 -8px 30px rgba(0,0,0,0.18);transition:bottom 0.35s ease;max-height:85vh;overflow:auto;z-index:3000}
.checkout-panel.active{bottom:0}
.checkout-item{display:flex;gap:12px;align-items:center;padding:8px 0;border-bottom:1px solid #f1f1f1}
.checkout-item img{width:70px;height:50px;object-fit:cover;border-radius:8px}
.grand{font-weight:900;font-size:18px;text-align:right;margin-top:8px}

/* options modal */
.modal{position:fixed;left:0;right:0;top:0;bottom:0;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;z-index:4000;padding:12px}
.modal-box{width:100%;max-width:480px;background:#fff;border-radius:12px;padding:14px}
.option-row{display:flex;gap:8px;align-items:center;margin:8px 0}
.option-label{flex:1;font-weight:800}
.option-choice{padding:8px 12px;border-radius:8px;border:1px solid #eee;cursor:pointer}
.small-muted{font-size:13px;color:var(--muted);margin-top:6px;display:block;text-align:center}

/* responsive */
@media(max-width:900px){
  .grid{grid-template-columns:repeat(3,1fr)}
}
@media(max-width:700px){
  .grid{grid-template-columns:repeat(2,1fr)}
  .card img{height:120px}
  .header-title{font-size:22px}
  .header-logo{width:56px;height:56px}
  .header-title{font-size:20px}
}
</style>
</head>
<body>
<header>
  <img src="images/logo.png" class="header-logo" alt="logo" />
  <div>
    <div class="header-title">Abdul Hadi Fast Food</div>
    <div class="header-sub">Order online · Confirmed by voice · Fast delivery</div>
  </div>
</header>

<div class="container">
  <!-- categories nav (anchors jump to sections) -->
  <div class="cat-nav" id="catNav">
    <a href="#deals">Deals</a>
    <a href="#burgers">Burgers</a>
    <a href="#sandwiches">Sandwiches</a>
    <a href="#broast">Broast</a>
    <a href="#naan">Naan</a>
    <a href="#fries">Fries</a>
    <a href="#pizza-fries">Pizza Fries</a>
    <a href="#boti">Boti</a>
    <a href="#barbeque">Barbeque</a>
    <a href="#icecream">Ice Cream</a>
    <a href="#soups">Soups</a>
    <a href="#shakes">Shakes</a>
    <a href="#kabab">Kabab</a>
    <a href="#rolls">Rolls</a>
    <a href="#beverages">Beverages</a>
    <a href="#extras">Extras</a>
  </div>

  <!-- DEALS first -->
  <section id="deals">
    <div class="section-header">
      <div class="section-banner">DEALS</div>
    </div>
    <div class="deals-grid" id="dealsGrid"></div>
  </section>

  <!-- Burgers -->
  <section id="burgers">
    <div class="section-header">
      <div class="section-banner">BURGERS</div>
    </div>
    <div class="grid" id="burgersGrid"></div>
  </section>

  <!-- Sandwiches -->
  <section id="sandwiches">
    <div class="section-header">
      <div class="section-banner">SANDWICHES</div>
    </div>
    <div class="grid" id="sandwichesGrid"></div>
  </section>

  <!-- Broast -->
  <section id="broast">
    <div class="section-header">
      <div class="section-banner">BROAST</div>
    </div>
    <div class="grid" id="broastGrid"></div>
  </section>

  <!-- Naan -->
  <section id="naan">
    <div class="section-header">
      <div class="section-banner">NAAN</div>
    </div>
    <div class="grid" id="naanGrid"></div>
  </section>

  <!-- Fries -->
  <section id="fries">
    <div class="section-header">
      <div class="section-banner">FRIES</div>
    </div>
    <div class="grid" id="friesGrid"></div>
  </section>

  <!-- Pizza Fries -->
  <section id="pizza-fries">
    <div class="section-header">
      <div class="section-banner">PIZZA FRIES</div>
    </div>
    <div class="grid" id="pizzafrGrid"></div>
  </section>

  <!-- Boti -->
  <section id="boti">
    <div class="section-header">
      <div class="section-banner">BOTI</div>
    </div>
    <div class="grid" id="botiGrid"></div>
  </section>

  <!-- Barbeque / Tikka -->
  <section id="barbeque">
    <div class="section-header">
      <div class="section-banner">BARBEQUE / TIKKA</div>
    </div>
    <div class="grid" id="barbequeGrid"></div>
  </section>

  <!-- Ice Cream -->
  <section id="icecream">
    <div class="section-header">
      <div class="section-banner">ICE CREAM</div>
    </div>
    <div class="grid" id="icecreamGrid"></div>
  </section>

  <!-- Soups -->
  <section id="soups">
    <div class="section-header">
      <div class="section-banner">SOUPS</div>
    </div>
    <div class="grid" id="soupsGrid"></div>
  </section>

  <!-- Shakes -->
  <section id="shakes">
    <div class="section-header">
      <div class="section-banner">SHAKES</div>
    </div>
    <div class="grid" id="shakesGrid"></div>
  </section>

  <!-- Kabab -->
  <section id="kabab">
    <div class="section-header">
      <div class="section-banner">KABAB</div>
    </div>
    <div class="grid" id="kababGrid"></div>
  </section>

  <!-- Rolls -->
  <section id="rolls">
    <div class="section-header">
      <div class="section-banner">ROLLS</div>
    </div>
    <div class="grid" id="rollsGrid"></div>
  </section>

  <!-- Beverages -->
  <section id="beverages">
    <div class="section-header">
      <div class="section-banner">BEVERAGES</div>
    </div>
    <div class="grid" id="beveragesGrid"></div>
  </section>

  <!-- Extras -->
  <section id="extras">
    <div class="section-header">
      <div class="section-banner">EXTRAS</div>
    </div>
    <div class="grid" id="extrasGrid"></div>
  </section>
</div>

<!-- cart bar -->
<div class="cart-bar" id="cartBar" onclick="openCheckout()">
  Cart: <span id="cartCount">0</span> items - <span id="cartTotal">Rs. 0</span>
</div>

<!-- checkout panel -->
<div class="checkout-panel" id="checkoutPanel">
  <div style="display:flex;justify-content:space-between;align-items:center">
    <h3 style="color:var(--accent)">Your Order</h3>
    <button class="btn" onclick="closeCheckout()">Close</button>
  </div>
  <div id="checkoutList" style="margin-top:12px"></div>
  <div class="grand" id="grandTotal">Total: Rs. 0</div>
  <div style="text-align:center;margin-top:12px">
    <button class="btn" onclick="sendOrder()">Order on WhatsApp</button>
  </div>
</div>

<!-- options modal -->
<div id="optionsModal" style="display:none" class="modal">
  <div class="modal-box" id="modalBox">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <h3 id="modalTitle">Options</h3>
      <button class="btn" onclick="closeOptions()">Close</button>
    </div>
    <div id="optionsArea" style="margin-top:10px"></div>
    <div style="display:flex;gap:8px;justify-content:center;margin-top:12px">
      <button class="btn" onclick="confirmOptions()">Add to Cart</button>
    </div>
  </div>
</div>

<footer style="text-align:center;padding:18px;color:var(--muted);margin-top:18px">© 2025 Abdul Hadi Fast Food</footer>

<script>
/* ============================
   Data — menu & options
   ============================ */
const PHONE = '92' + '3158377135'; // change if needed

const deals = [
  {id:'deal1', title:'Deal 1 — Buy 4 zinger get 1 free', price:1000, img:'images/deal_1.jpg'},
  {id:'deal2', title:'Deal 2 — 2 zinger + Next Cola 245ml', price:550, img:'images/deal_2.jpg'},
  {id:'deal3', title:'Deal 3 — 1 zinger + 1 club + Next Cola 1L', price:600, img:'images/deal_3.jpg'},
  {id:'deal4', title:'Deal 4 — 2 zinger + free fries', price:500, img:'images/deal_4.jpg'},
  {id:'deal5', title:'Deal 5 — 1 zinger + 1 club + 2 ice cream', price:750, img:'images/deal_5.jpg'},
  {id:'deal6', title:'Deal 6 — 3 zinger + Next Cola 1L', price:850, img:'images/deal_6.jpg'},
  {id:'deal7', title:'Deal 7 — 1 QTR broast (leg) + 1 club + 1 zinger', price:800, img:'images/deal_7.jpg'},
  {id:'deal8', title:'Deal 8 — 2 zinger + 1 club + 1 chicken roll', price:850, img:'images/deal_8.jpg'},
  {id:'family', title:'Family Deal — 2 zinger,2 chicken burger,1 club,2 zinger roll,1 next cola 1L', price:1700, img:'images/family_deal.jpg'}
];

// utility to create an ID for item variant in cart
function variantId(baseId, opts){ return baseId + '|' + Object.values(opts).join('|'); }

// items (kept same as you sent; image names same)
const items = [
  {id:'zinger', name:'Zinger Burger', price:250, img:'images/zinger_burger.jpg', category:'burgers',
    options:{cheese:{type:'boolean',label:'With Cheese (+Rs50)',price:50}}},
  {id:'zinger_mini', name:'Mini Burger', price:200, img:'images/mini_burger.jpg', category:'burgers',
    options:{cheese:{type:'boolean',label:'With Cheese (+Rs50)',price:50}}},
  {id:'jumbo_zinger', name:'Jumbo Zinger', price:450, img:'images/jumbo_zinger.jpg', category:'burgers',
    options:{cheese:{type:'boolean',label:'With Cheese (+Rs50)',price:50}}},
  {id:'chicken_burger', name:'Chicken Burger', price:250, img:'images/chicken_burger.jpg', category:'burgers',
    options:{cheese:{type:'boolean',label:'With Cheese (+Rs50)',price:50}}},
  {id:'beef_burger', name:'Beef Burger', price:300, img:'images/beef_burger.jpg', category:'burgers',
    options:{cheese:{type:'boolean',label:'With Cheese (+Rs50)',price:50}}},
  {id:'tow_in_one', name:'Tow in One Burger', price:500, img:'images/two_in_one.jpg', category:'burgers'},
  {id:'jumbo_beef', name:'Jumbo Beef Burger', price:450, img:'images/beef_jumbo.jpg', category:'burgers'},

  {id:'chicken_sandwich', name:'Chicken Sandwich', price:200, img:'images/chicken_sandwich.jpg', category:'sandwiches',
    options:{cheese:{type:'boolean',label:'With Cheese (+Rs50)',price:50}}},
  {id:'club_sandwich', name:'Club Sandwich', price:250, img:'images/club_sandwich.jpg', category:'sandwiches',
    options:{cheese:{type:'boolean',label:'With Cheese (+Rs50)',price:50}}},
  {id:'crispy_sandwich', name:'Crispy Sandwich', price:300, img:'images/crispy_sandwich.jpg', category:'sandwiches',
    options:{cheese:{type:'boolean',label:'With Cheese (+Rs50)',price:50}}},
  {id:'bbq_sandwich', name:'BBQ Sandwich', price:350, img:'images/bbq_sandwich.jpg', category:'sandwiches'},
  {id:'malai_sandwich', name:'Malai Sandwich', price:400, img:'images/malai_sandwich.jpg', category:'sandwiches'},

  {id:'qtr_chest', name:'Qtr Broast', price:350, img:'images/qtr_broast.jpg', category:'broast', options:{part:{type:'select',label:'Part',values:{chest:50,leg:0}}}},
  {id:'crispy_broast', name:'Crispy Broast', price:400, img:'images/crispy_broast.jpg', category:'broast', options:{part:{type:'select',label:'Part',values:{chest:50,leg:0}}}},
  {id:'spicy_broast', name:'Spicy Broast', price:500, img:'images/spicy_broast.jpg', category:'broast'},

  {id:'chapati', name:'Chapati', price:20, img:'images/chapati.jpg', category:'naan'},
  {id:'puri_small', name:'Puri Paratha Small', price:50, img:'images/puri_small.jpg', category:'naan'},
  {id:'puri', name:'Puri Paratha', price:80, img:'images/puri.jpg', category:'naan'},

  {id:'plain_fries', name:'Plain Fries', price:100, img:'images/plain_fries.jpg', category:'fries'},
  {id:'masala_fries', name:'Masala Fries', price:100, img:'images/masala_fries.jpg', category:'fries'},
  {id:'mayo_fries', name:'Mayo Fries', price:150, img:'images/mayo_fries.jpg', category:'fries'},
  {id:'mayo_garlic_fries', name:'Mayo Garlic Fries', price:200, img:'images/mayo_garlic_fries.jpg', category:'fries'},

  {id:'pizza_fries', name:'Pizza Fries', price:300, img:'images/pizza_fries_med.jpg', category:'pizza-fries', options:{size:{type:'select',label:'Size',values:{medium:0,large:100}}}},
  {id:'matkka_fries', name:'Matkka Fries', price:350, img:'images/matka_fries_med.jpg', category:'pizza-fries', options:{size:{type:'select',label:'Size',values:{medium:0,large:250}}}},
  {id:'chicken_fries', name:'Chicken Fries', price:250, img:'images/chicken_fries_med.jpg', category:'pizza-fries', options:{size:{type:'select',label:'Size',values:{medium:0,large:100}}}},

  {id:'chicken_boti', name:'Chicken Boti', price:350, img:'images/chicken_boti.jpg', category:'boti'},
  {id:'beef_boti', name:'Beef Boti', price:450, img:'images/beef_boti.jpg', category:'boti'},
  {id:'malai_boti', name:'Malai Boti', price:400, img:'images/malai_boti.jpg', category:'boti'},
  {id:'bihari_boti', name:'Bihari Boti', price:400, img:'images/bihari_boti.jpg', category:'boti', options:{meat:{type:'select',label:'Meat',values:{chicken:0,beef:50}}}},

  {id:'chicken_tikka', name:'Chicken Tikka', price:400, img:'images/chicken_tikka_chest.jpg', category:'barbeque', options:{part:{type:'select',label:'Part',values:{chest:50,leg:0}}}},
  {id:'malai_tikka', name:'Malai Tikka', price:450, img:'images/malai_tikka.jpg', category:'barbeque'},
  {id:'green_tikka', name:'Green Tikka', price:450, img:'images/green_tikka.jpg', category:'barbeque'},

  {id:'single_scope', name:'Single Scoop', price:100, img:'images/single_scoop.jpg', category:'icecream', options:{size:{type:'select',label:'Scoop',values:{single:0,double:80}}}},

  {id:'hot_sour_soup', name:'Hot & Sour Soup', price:180, img:'images/hot_sour_soup.jpg', category:'soups'},
  {id:'corn_soup', name:'Corn Soup', price:150, img:'images/corn_soup.jpg', category:'soups'},
  {id:'veg_soup', name:'Vegetable Soup', price:130, img:'images/veg_soup.jpg', category:'soups'},

  {id:'kitkat_shake', name:'Kitkat Shake', price:300, img:'images/kitkat_shake.jpg', category:'shakes'},
  {id:'oreo_shake', name:'Oreo Shake', price:250, img:'images/oreo_shake.jpg', category:'shakes'},
  {id:'strawberry_shake', name:'Strawberry Shake', price:250, img:'images/strawberry_shake.jpg', category:'shakes'},

  {id:'reshmy_kabab', name:'Reshmy Kabab', price:400, img:'images/reshmy_kabab.jpg', category:'kabab'},
  {id:'gola_kabab', name:'Gola Kabab', price:400, img:'images/gola_kabab.jpg', category:'kabab'},

  {id:'chicken_roll', name:'Chicken Roll', price:160, img:'images/chicken_roll.jpg', category:'rolls', options:{cheese:{type:'boolean',label:'With Cheese (+Rs50)',price:50}}},
  {id:'beef_roll', name:'Beef Roll', price:200, img:'images/beef_roll.jpg', category:'rolls'},
  {id:'shawarma_roll', name:'Shawarma Roll', price:250, img:'images/shawarma_roll.jpg', category:'rolls'},

  {id:'cold_drink_300', name:'Cold Drink 300ml', price:70, img:'images/cold_drink.jpg', category:'beverages'},
  {id:'next_col_245', name:'Next Cola 245ml', price:90, img:'images/next_cola_245.jpg', category:'beverages'},
  {id:'next_col_1l', name:'Next Cola 1 Litre', price:150, img:'images/next_cola_1l.jpg', category:'beverages'},

  {id:'mayo_dip', name:'Mayo Sauce Dip', price:80, img:'images/mayo_dip.jpg', category:'extras'},
  {id:'ketchup_dip', name:'Ketchup Dip', price:80, img:'images/ketchup_dip.jpg', category:'extras'}
];

// CART structure
let cart = {};

// Track deal UI qty toggles
let dealUiState = {}; // e.g. {deal1: true/false}

// Render functions
function renderDeals(){
  const el = document.getElementById('dealsGrid'); el.innerHTML = '';
  deals.forEach(d=>{
    const node = document.createElement('div'); node.className='deal-card';
    node.innerHTML = `
      <img src="${d.img}" alt="${d.title}">
      <div class="deal-info">
        <div style="font-weight:900">${d.title}</div>
        <div style="color:var(--accent);font-weight:900;margin-top:6px">Rs. ${d.price}</div>
        <div style="display:flex;gap:8px;margin-top:10px" id="deal-controls-${d.id}">
          <div class="qty-controls" id="deal-qty-${d.id}" style="display:none">
            <button class="qty-btn" onclick="decreaseDeal('${d.id}', ${d.price})">−</button>
            <div class="qty-num" id="deal-qty-num-${d.id}">0</div>
            <button class="qty-btn" onclick="increaseDeal('${d.id}', ${d.price})">+</button>
          </div>
          <button class="btn deal-buy" id="deal-buy-${d.id}" onclick="handleDealBuy('${d.id}', ${d.price})">Buy</button>
        </div>
      </div>`;
    el.appendChild(node);
    // default ui state
    dealUiState[d.id] = false;
  });
}

function renderGrid(category, containerId){
  const container = document.getElementById(containerId); container.innerHTML = '';
  items.filter(i => i.category===category).forEach(it=>{
    const card = document.createElement('div'); card.className='card';
    card.innerHTML = `<img src="${it.img}" alt="${it.name}"><div class="name">${it.name}</div><div class="price">Rs. ${it.price}</div>
      <div class="controls" id="controls-${it.id}"></div>`;
    container.appendChild(card);
    const ctrl = card.querySelector(`#controls-${it.id}`);
    ctrl.innerHTML = `<div class="qty-controls" id="qty-controls-${it.id}" style="display:none">
        <button class="qty-btn" onclick="decreaseFromVariant('${it.id}')">−</button>
        <div class="qty-num" id="qty-num-${it.id}">0</div>
        <button class="qty-btn" onclick="increaseFromVariant('${it.id}')">+</button>
      </div>
      <button class="btn buy-btn" id="buy-${it.id}" onclick="handleBuy('${it.id}')">Buy</button>`;
  });
}

// initial render
renderDeals();
renderGrid('burgers','burgersGrid');
renderGrid('sandwiches','sandwichesGrid');
renderGrid('broast','broastGrid');
renderGrid('naan','naanGrid');
renderGrid('fries','friesGrid');
renderGrid('pizza-fries','pizzafrGrid');
renderGrid('boti','botiGrid');
renderGrid('barbeque','barbequeGrid');
renderGrid('icecream','icecreamGrid');
renderGrid('soups','soupsGrid');
renderGrid('shakes','shakesGrid');
renderGrid('kabab','kababGrid');
renderGrid('rolls','rollsGrid');
renderGrid('beverages','beveragesGrid');
renderGrid('extras','extrasGrid');

/* Options modal logic (unchanged design) */
let currentPicking = null;
function openOptions(id, type='item', basePrice){
  let base = null;
  if(type==='deal'){
    base = deals.find(d=>d.id===id);
    currentPicking = {type:'deal', id:id, base:base, price:base.price};
  } else {
    base = items.find(i=>i.id===id);
    currentPicking = {type:'item', id:id, base:base, price:base.price};
  }
  const modal = document.getElementById('optionsModal');
  const optsArea = document.getElementById('optionsArea');
  const title = document.getElementById('modalTitle');
  optsArea.innerHTML = ''; title.innerText = (base ? base.name : 'Deal');
  if(currentPicking.type==='deal'){
    optsArea.innerHTML = `<div style="padding:12px;text-align:center">This is a deal. Click Add to cart.</div>`;
    modal.style.display='flex';
    return;
  }
  const opts = base.options || null;
  if(!opts){
    optsArea.innerHTML = `<div style="padding:12px;text-align:center">No options for this item. Click Add to cart to add one unit.</div>`;
    modal.style.display='flex';
    return;
  }
  for(const [key,opt] of Object.entries(opts)){
    if(opt.type==='boolean'){
      const idEl = `opt_${key}`;
      const row = document.createElement('div'); row.className='option-row';
      row.innerHTML = `<div class="option-label">${opt.label}</div>
        <div><button class="option-choice" id="${idEl}" data-key="${key}" data-type="boolean">No</button></div>`;
      optsArea.appendChild(row);
      setTimeout(()=>{document.getElementById(idEl).onclick = ()=>{
        const el = document.getElementById(idEl);
        if(el.innerText==='No'){ el.innerText='Yes'; el.dataset.selected='1'; el.style.backgroundColor='#f0f0f0';}
        else {el.innerText='No'; el.dataset.selected='0'; el.style.backgroundColor='';}
      }},100);
    } else if(opt.type==='select'){
      const row = document.createElement('div'); row.className='option-row';
      row.innerHTML = `<div class="option-label">${opt.label}</div><div id="select-${key}" style="display:flex;gap:6px"></div>`;
      optsArea.appendChild(row);
      const selDivId = `select-${key}`;
      for(const [valName,valPrice] of Object.entries(opt.values)){
        const btn = document.createElement('button'); btn.className='option-choice';
        btn.innerText = `${capitalize(valName)} ${valPrice ? '+'+valPrice : ''}`;
        btn.onclick = ()=> {
          const children = document.getElementById(selDivId).querySelectorAll('.option-choice');
          children.forEach(c=>c.style.border='1px solid #eee');
          btn.style.border='2px solid var(--accent)';
          btn.dataset.selected = valName;
        };
        document.getElementById(selDivId).appendChild(btn);
      }
    }
  }
  modal.style.display='flex';
}
function closeOptions(){ document.getElementById('optionsModal').style.display='none'; currentPicking=null; document.getElementById('optionsArea').innerHTML=''; }
function capitalize(s){ if(!s) return s; return s.charAt(0).toUpperCase()+s.slice(1); }

/* Add to cart logic */
function confirmOptions(){
  if(!currentPicking) return;
  if(currentPicking.type==='deal'){
    const id = variantId(currentPicking.id, {deal:'1'});
    if(!cart[id]) cart[id] = {variantId:id, baseId:currentPicking.id, name:currentPicking.base.title, price:currentPicking.price, qty:0, img:currentPicking.base.img, opts:{}};
    cart[id].qty += 1;
    updateCartDisplay();
    closeOptions();
    // enable deal qty controls in UI
    toggleDealQtyControls(currentPicking.id, true);
    return;
  }
  const base = currentPicking.base;
  const optsDef = base.options || {};
  const selected = {};
  for(const [k,v] of Object.entries(optsDef)){
    if(v.type==='boolean'){
      const el = document.getElementById(`opt_${k}`);
      selected[k] = (el && el.dataset.selected==='1') ? 'yes':'no';
    } else if(v.type==='select'){
      const selRoot = document.getElementById(`select-${k}`);
      let chosen = null;
      if(selRoot){
        const buttons = selRoot.querySelectorAll('.option-choice');
        buttons.forEach(b=>{ if(b.dataset.selected) chosen = b.dataset.selected; });
      }
      selected[k] = chosen || Object.keys(v.values)[0];
    }
  }
  let optPrice = 0;
  for(const [k,v] of Object.entries(optsDef)){
    if(v.type==='boolean'){ if(selected[k]==='yes') optPrice += v.price || 0; }
    else if(v.type==='select'){ const val = selected[k]; const valPrice = (v.values && v.values[val]) ? v.values[val] : 0; optPrice += valPrice; }
  }
  const totalPrice = base.price + optPrice;
  const varId = variantId(base.id, selected);
  const varNameParts = [base.name];
  for(const [k,v] of Object.entries(selected)){
    if(v && v!=='no' && v!=='regular' && v!=='medium') varNameParts.push(capitalize(k)+':'+capitalize(String(v)));
    if(v==='yes') varNameParts.push(k==='cheese' ? 'With Cheese' : capitalize(k));
    if(v==='large') varNameParts.push('(Large)');
  }
  const varName = varNameParts.join(' ');
  if(!cart[varId]) cart[varId] = {variantId:varId, baseId:base.id, name:varName, price:totalPrice, qty:0, img:base.img, opts:selected};
  cart[varId].qty += 1;
  updateCartDisplay();
  closeOptions();
}

/* Items without options quick handlers */
function handleBuy(baseId){
  const base = items.find(i=>i.id===baseId);
  if(!base) return;
  if(base.options) { openOptions(baseId,'item'); return; }
  const varId = variantId(baseId, {});
  if(!cart[varId]) cart[varId] = {variantId:varId, baseId:baseId, name:base.name, price:base.price, qty:0, img:base.img, opts:{}};
  cart[varId].qty += 1;
  toggleQtyControls(baseId, true);
  updateCartDisplay();
}
function increaseFromVariant(baseId){
  const vid = Object.keys(cart).find(k=>cart[k].baseId===baseId && Object.keys(cart[k].opts || {}).length===0);
  if(vid){ cart[vid].qty += 1; updateCartDisplay(); toggleQtyControls(baseId,true); return; }
  handleBuy(baseId);
}
function decreaseFromVariant(baseId){
  const vid = Object.keys(cart).find(k=>cart[k].baseId===baseId && Object.keys(cart[k].opts || {}).length===0);
  if(!vid) return;
  cart[vid].qty = Math.max(0, cart[vid].qty - 1);
  if(cart[vid].qty===0) delete cart[vid];
  updateCartDisplay();
  const exists = Object.keys(cart).some(k=>cart[k].baseId===baseId);
  toggleQtyControls(baseId, exists);
}
function toggleQtyControls(baseId, show){
  const qc = document.getElementById(`qty-controls-${baseId}`);
  const buyBtn = document.getElementById(`buy-${baseId}`);
  if(qc) qc.style.display = show ? 'flex':'none';
  if(buyBtn) buyBtn.style.display = show ? 'none':'inline-block';
  if(show){
    const numEl = document.getElementById(`qty-num-${baseId}`);
    const vid = Object.keys(cart).find(k=>cart[k].baseId===baseId && Object.keys(cart[k].opts || {}).length===0);
    numEl && (numEl.innerText = vid ? cart[vid].qty : 0);
  }
}

/* Deal buy handlers (shows qty inline on the deal card) */
function handleDealBuy(dealId, price){
  // Add deal directly to cart and show qty controls
  const id = variantId(dealId, {deal:'1'});
  const dealBase = deals.find(d=>d.id===dealId);
  if(!cart[id]) cart[id] = {variantId:id, baseId:dealId, name:dealBase.title, price:price, qty:0, img:dealBase.img, opts:{}};
  cart[id].qty += 1;
  toggleDealQtyControls(dealId, true);
  updateCartDisplay();
}
function increaseDeal(dealId, price){
  const id = variantId(dealId, {deal:'1'});
  if(!cart[id]) {
    const dealBase = deals.find(d=>d.id===dealId);
    cart[id] = {variantId:id, baseId:dealId, name:dealBase.title, price:price, qty:0, img:dealBase.img, opts:{}};
  }
  cart[id].qty += 1;
  document.getElementById(`deal-qty-num-${dealId}`).innerText = cart[id].qty;
  updateCartDisplay();
}
function decreaseDeal(dealId, price){
  const id = variantId(dealId, {deal:'1'});
  if(!cart[id]) return;
  cart[id].qty = Math.max(0, cart[id].qty - 1);
  if(cart[id].qty===0) delete cart[id];
  document.getElementById(`deal-qty-num-${dealId}`).innerText = cart[id] ? cart[id].qty : 0;
  updateCartDisplay();
  const exists = Object.keys(cart).some(k=>cart[k].baseId===dealId);
  toggleDealQtyControls(dealId, exists);
}
function toggleDealQtyControls(dealId, show){
  const qc = document.getElementById(`deal-qty-${dealId}`);
  const buyBtn = document.getElementById(`deal-buy-${dealId}`);
  if(qc) qc.style.display = show ? 'flex':'none';
  if(buyBtn) buyBtn.style.display = show ? 'none':'inline-block';
  if(show){
    const num = document.getElementById(`deal-qty-num-${dealId}`);
    const id = Object.keys(cart).find(k=>cart[k].baseId===dealId);
    num && (num.innerText = id ? cart[id].qty : 0);
  }
}

/* Cart rendering and WhatsApp builder */
function updateCartDisplay(){
  let totalQty=0, totalPrice=0;
  for(const k of Object.keys(cart)) {
    totalQty += cart[k].qty;
    totalPrice += cart[k].qty * cart[k].price;
  }
  document.getElementById('cartCount').innerText = totalQty;
  document.getElementById('cartTotal').innerText = 'Rs. ' + totalPrice;
  document.getElementById('grandTotal').innerText = 'Total: Rs. ' + totalPrice;

  const list = document.getElementById('checkoutList'); list.innerHTML = '';
  if(Object.keys(cart).length===0){
    list.innerHTML = '<p style="text-align:center;color:var(--muted)">Your cart is empty.</p>';
    return;
  }
  for(const k of Object.keys(cart)){
    const it = cart[k];
    if(it.qty<=0) continue;
    const div = document.createElement('div'); div.className='checkout-item';
    div.innerHTML = `<img src="${it.img}" alt="${it.name}"><div style="flex:1"><div style="font-weight:900">${it.name}</div><div style="color:var(--muted);font-size:13px">${it.qty} x Rs. ${it.price}</div></div>
      <div style="text-align:right"><div style="font-weight:900">Rs. ${it.qty * it.price}</div>
      <div style="display:flex;gap:6px;margin-top:6px;justify-content:flex-end">
        <button class="qty-btn" onclick="changeCartQty('${k}',-1)">−</button>
        <div style="min-width:22px;text-align:center">${it.qty}</div>
        <button class="qty-btn" onclick="changeCartQty('${k}',1)">+</button>
      </div></div>`;
    list.appendChild(div);
  }
}
function changeCartQty(variantKey,delta){
  if(!cart[variantKey]) return;
  cart[variantKey].qty += delta;
  if(cart[variantKey].qty<=0) delete cart[variantKey];
  updateCartDisplay();
  const base = cart[variantKey] ? cart[variantKey].baseId : variantKey.split('|')[0];
  const exists = Object.keys(cart).some(k=>cart[k].baseId===base);
  // sync item card toggles
  toggleQtyControls(base, exists);
  // sync deal toggles
  if(document.getElementById(`deal-qty-${base}`) !== null) toggleDealQtyControls(base, exists);
}

/* open/close checkout */
function openCheckout(){ document.getElementById('checkoutPanel').classList.add('active'); }
function closeCheckout(){ document.getElementById('checkoutPanel').classList.remove('active'); }

/* WhatsApp order builder */
function sendOrder(){
  if(Object.keys(cart).length===0){ alert('Cart is empty'); return; }
  let lines = [];
  lines.push('Assalamualaikum, I want to place an order:');
  for(const k of Object.keys(cart)){
    const it = cart[k];
    if(it.qty<=0) continue;
    lines.push('• ' + it.name + ' x ' + it.qty + ' = Rs ' + (it.price * it.qty));
  }
  let total=0; Object.keys(cart).forEach(k=> total += (cart[k].price * cart[k].qty));
  lines.push('');
  lines.push('Total: Rs ' + total);
  lines.push('Name: ');
  lines.push('Phone: ');
  lines.push('Address: ');
  const msg = lines.join('\n');
  const url = 'https://wa.me/' + PHONE + '?text=' + encodeURIComponent(msg);
  window.open(url,'_blank');
}

/* init state (all qty controls hidden, buy shown) */
function initZeroState(){
  items.forEach(i=>{ toggleQtyControls(i.id, false); });
  deals.forEach(d=>{ toggleDealQtyControls(d.id, false); });
  updateCartDisplay();
}
initZeroState();

</script>
</body>
</html>
